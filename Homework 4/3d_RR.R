source("rrline.r")
X1 = c(61, 54, 70, 81, 46, 63, 54, 44, 53, 60, 80, 25, 59, 42, 34, 46, 63, 62, 67, 54, 31, 54, 31, 26, 41, 34, 42, 82, 202, 89, 84, 133, 85, 51, 91, 45, 102, 48, 60, 201)
X2 = c(38, 47, 40, 40, 36, 37, 37, 35, 36, 42, 52, 34, 37, 42, 37, 37, 37, 39, 39, 41, 37, 38, 37, 43, 39, 34, 35, 44, 57, 46, 61, 50, 35, 37, 37, 37, 38, 33, 37, 61)
X3 = c(127, 213, 134, 131, 116, 127, 128, 114, 123, 130, 177, 104, 113, 112, 91, 108, 126, 122, 121, 122, 96, 118, 88, 95, 101, 90, 101, 125, 231, 145, 214, 158, 148, 114, 144, 113, 151, 106, 120, 88)
X4 = c(144, 152, 149, 219, 174, 171, 178, 125, 213, 191, 194, 96, 167, 118, 165, 135, 178, 243, 107, 176, 109, 146, 104, 70, 156, 157, 136, 257, 276, 141, 177, 140, 198, 154, 152, 119, 171, 151, 204, 70)
X5 = c(50, 37, 40, 67, 48, 50, 85, 58, 78, 52, 59, 19, 45, 32, 31, 41, 57, 48, 64, 63, 46, 41, 31, 15, 38, 49, 49, 108, 153, 124, 138, 88, 54, 72, 70, 40, 57, 84, 42, 15)
y = c(92, 163, 215, 210, 128, 239, 317, 195, 108, 158, 263, 101, 266, 290, 169, 168, 146, 145, 195, 254, 99, 146, 132, 105, 131, 198, 237, 202, 461, 350, 275, 467, 201, 169, 253, 202, 195, 140, 179, 467)
df<-as.data.frame(cbind(X1,X2,X3,X4,X5,y))
X11 = c(61, 54, 70, 81, 46, 63, 54, 44, 53, 60, 80, 25, 59, 42, 34, 46, 63, 62, 67, 54, 31, 54, 31, 26, 41, 34, 42, 82, 202, 89, 84, 133, 85, 51, 91, 45, 102, 48, 60)
X22 = c(38, 47, 40, 40, 36, 37, 37, 35, 36, 42, 52, 34, 37, 42, 37, 37, 37, 39, 39, 41, 37, 38, 37, 43, 39, 34, 35, 44, 57, 46, 61, 50, 35, 37, 37, 37, 38, 33, 37)
X33 = c(127, 213, 134, 131, 116, 127, 128, 114, 123, 130, 177, 104, 113, 112, 91, 108, 126, 122, 121, 122, 96, 118, 88, 95, 101, 90, 101, 125, 231, 145, 214, 158, 148, 114, 144, 113, 151, 106, 120)
X44 = c(144, 152, 149, 219, 174, 171, 178, 125, 213, 191, 194, 96, 167, 118, 165, 135, 178, 243, 107, 176, 109, 146, 104, 70, 156, 157, 136, 257, 276, 141, 177, 140, 198, 154, 152, 119, 171, 151, 204)
X55 = c(50, 37, 40, 67, 48, 50, 85, 58, 78, 52, 59, 19, 45, 32, 31, 41, 57, 48, 64, 63, 46, 41, 31, 15, 38, 49, 49, 108, 153, 124, 138, 88, 54, 72, 70, 40, 57, 84, 42)
y2 = c(92, 163, 215, 210, 128, 239, 317, 195, 108, 158, 263, 101, 266, 290, 169, 168, 146, 145, 195, 254, 99, 146, 132, 105, 131, 198, 237, 202, 461, 350, 275, 467, 201, 169, 253, 202, 195, 140, 179)
df<-as.data.frame(cbind(X11,X22,X33,X44,X55,y2))
par(mfrow=c(3,2),mar=c(2.5,2.5,1,1))
plot(X1,y)
a<-run.rrline(X1,y)
abline(a$aa$b,col="blue")
plot(X2,y)
b<-run.rrline(X2,y)
abline(b$a,b$b,col="blue")
plot(X3,y)
c<-run.rrline(x3,y)
abline(c$a,c$b,col="blue")
plot(X4,y)
d<-run.rrline(X4,y)
abline(d$a,d$b,col="blue")
plot(X4,y)
e<-run.rrline(X5,y)
abline(e$a,e$b,col="blue")

#Transformations
y1<-y-(a$a+a$b*X1)

par(mfrow=c(3,2),mar=c(2.5,2.5,1,1))
plot(X1,y1)
a<-run.rrline(X1,y1)
abline(a$aa$b,col="blue")
plot(X2,y1)
b<-run.rrline(X2,y1)
abline(b$a,b$b,col="blue")
plot(X3,y1)
c<-run.rrline(x3,y1)
abline(c$a,c$b,col="blue")
plot(X4,y1)
d<-run.rrline(X4,y1)
abline(d$a,d$b,col="blue")
plot(X4,y1)
e<-run.rrline(X5,y1)
abline(e$a,e$b,col="blue")


rr<-run.rrline(X2,y1)
y12<-y1-(rr$a+rr$b*X2)

par(mfrow=c(3,2),mar=c(2.5,2.5,1,1))
plot(X1,y)
a<-run.rrline(X1,y)
abline(a$aa$b,col="blue")
plot(X2,y)
b<-run.rrline(X2,y)
abline(b$a,b$b,col="blue")
plot(X3,y)
c<-run.rrline(x3,y)
abline(c$a,c$b,col="blue")
plot(X4,y)
d<-run.rrline(X4,y)
abline(d$a,d$b,col="blue")
plot(X4,y)
e<-run.rrline(X5,y)
abline(e$a,e$b,col="blue")

#Transformations
y1<-y-(a$a+a$b*X1)

par(mfrow=c(3,2),mar=c(2.5,2.5,1,1))
plot(X1,y12)
a<-run.rrline(X1,y12)
abline(a$aa$b,col="blue")
plot(X2,y12)
b<-run.rrline(X2,y12)
abline(b$a,b$b,col="blue")
plot(X3,y12)
c<-run.rrline(x3,y12)
abline(c$a,c$b,col="blue")
plot(X4,y12)
d<-run.rrline(X4,y12)
abline(d$a,d$b,col="blue")
plot(X4,y12)
e<-run.rrline(X5,y12)
abline(e$a,e$b,col="blue")

fit1<-lm(y12~X3)